unless specified below, all code contributed by Jason Robinson https://github.com/jjrobinson
